<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Njabulo Jb – Full‑Info Player</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body{font-family:sans-serif;padding:1em;max-width:600px;margin:auto}
    input{width:70%;padding:.4em}
    button{margin:.3em;padding:.4em .8em;background:#fff;border:1px solid #ccc;border-radius:4px}
    #player{margin-top:1em}
    #controls button{font-size:1.2em}
    #info{margin:.5em 0;font-size:.9em;color:#555}
    #time{display:inline-block;width:120px;font-family:monospace}
  </style>
</head>
<body>
  <h1>Njabulo Jb</h1>
  <input id="query" placeholder="Enter song name">
  <button onclick="search()">Search</button>

  <div id="result"></div>

  <div id="player" style="display:none">
    <div>Office Channel: Njabulo Jb</div>
    <img id="thumb" style="max-width:100%;border-radius:4px">
    <audio id="audio" controls></audio>
    <div id="controls">
      <button onclick="playPause()"><i id="playIcon" class="fa fa-play"></i></button>
      <button onclick="stop()"><i class="fa fa-stop"></i></button>
      <button onclick="rewind()"><i class="fa fa-rotate-left"></i></button>
      <button onclick="forward()"><i class="fa fa-forward"></i></button>
    </div>
    <div id="time">0:00 / 0:00</div>
    <div id="info"></div>
  </div>

  <script>
    // ---- configuration ----
    const YT_SEARCH_URL = 'https://noobs-api.top/dipto/ytSearch'; // replace with the actual endpoint you use
    const DOWNLOAD_MP3   = 'https://noobs-api.top/dipto/ytDl3?link=';
    // -----------------------

    let currentTrack = null;   // {title, url, thumbnail, timestamp, views, ago}
    let isPlaying   = false;

    async function search() {
      const q = document.getElementById('query').value.trim();
      if (!q) return alert('Please type a song name');

      const resp = await fetch(`${YT_SEARCH_URL}?q=${encodeURIComponent(q)}`);
      const data = await resp.json();

      const out = document.getElementById('result');
      out.innerHTML = '';

      if (!data.videos?.length) {
        out.textContent = 'No results found.';
        return;
      }

      const v = data.videos[0]; // first result
      const safeTitle = v.title.replace(/[\\/:*?"<>|]/g, '_');

      out.innerHTML = `
        <p><strong>${v.title}</strong></p>
        <img src="${v.thumbnail}" style="max-width:100px;display:block">
        <button onclick="loadTrack({
          title:      '${safeTitle}',
          url:        '${DOWNLOAD_MP3}${v.videoId}&format=mp3',
          thumbnail:  '${v.thumbnail}',
          timestamp:  '${v.timestamp}',
          views:      '${v.views}',
          ago:        '${v.ago}'
        })">Load Track</button>`;
    }

    function loadTrack(track) {
      currentTrack = track;
      const audio = document.getElementById('audio');
      const thumb = document.getElementById('thumb');
      const info  = document.getElementById('info');

      audio.src = track.url;
      audio.load();
      thumb.src = track.thumbnail;
      info.innerHTML = `
        <div>Duration: ${track.timestamp}</div>
        <div>Views: ${track.views}</div>
        <div>Uploaded: ${track.ago}</div>`;

      document.getElementById('player').style.display = 'block';
      audio.addEventListener('timeupdate', updateTime);
      playPause();
    }

    // ----- player controls -----
    function playPause() {
      const audio = document.getElementById('audio');
      const icon  = document.getElementById('playIcon');
      if (!currentTrack) return;

      if (isPlaying) {
        audio.pause();
        icon.className = 'fa fa-play';
      } else {
        audio.play();
        icon.className = 'fa fa-pause';
      }
      isPlaying = !isPlaying;
    }

    function stop() {
      const audio = document.getElementById('audio');
      audio.pause();
      audio.currentTime = 0;
      document.getElementById('playIcon').className = 'fa fa-play';
      isPlaying = false;
      updateTime();
    }

    function rewind() {
      const audio = document.getElementById('audio');
      audio.currentTime = Math.max(0, audio.currentTime - 10);
    }

    function forward() {
      const audio = document.getElementById('audio');
      audio.currentTime = Math.min(audio.duration, audio.currentTime + 10);
    }

    function updateTime() {
      const audio = document.getElementById('audio');
      const sec   = Math.floor(audio.currentTime);
      const dur   = Math.floor(audio.duration);
      document.getElementById('time').textContent =
        `${secToMMSS(sec)} / ${secToMMSS(dur)}`;
    }

    function secToMMSS(s) {
      const m = Math.floor(s / 60);
      const ss = s % 60;
      return `${m}:${ss < 10 ? '0' + ss : ss}`;
    }
  </script>
</body>
        </html> 
